DROP TABLE vgn_user IF EXISTS;

DROP TABLE vgn_string_tune IF EXISTS;

DROP TABLE vgn_neck_tune IF EXISTS;

DROP TABLE vgn_color_profile IF EXISTS;

DROP TABLE vgn_neck_profiles IF EXISTS;

DROP TABLE vgn_neck_settings IF EXISTS;

DROP TABLE vgn_neck_settings_octaves IF EXISTS;

DROP TABLE vgn_note_property IF EXISTS;

DROP TABLE VGN_NECK_SEQUENCES IF EXISTS;

DROP TABLE vgn_sequence IF EXISTS;

DROP TABLE vgn_sequence_interval IF EXISTS;

DROP SEQUENCE VGN_USER_SEQ IF EXISTS;
DROP SEQUENCE VGN_SEQUENCE_SEQ IF EXISTS;
DROP SEQUENCE VGN_SEQUENCE_INTERVAL_SEQ IF EXISTS;
DROP SEQUENCE VGN_NOTE_PROPERTY_SEQ IF EXISTS;
DROP SEQUENCE VGN_STRING_TUNE_SEQ IF EXISTS;
DROP SEQUENCE VGN_NECK_PROFILE_SEQ IF EXISTS;
DROP SEQUENCE VGN_NECK_TUNE_SEQ IF EXISTS;
DROP SEQUENCE VGN_SETTINGS_SEQ IF EXISTS;
DROP SEQUENCE VGN_NECK_SEQUENCE_SEQ IF EXISTS;
DROP SEQUENCE VGN_COLOR_PROFILE_SEQ IF EXISTS;
DROP SEQUENCE VGN_SETTINGS_OCTAVE_SEQ IF EXISTS;

CREATE SEQUENCE VGN_USER_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_SEQUENCE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_SEQUENCE_INTERVAL_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_NOTE_PROPERTY_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_STRING_TUNE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_NECK_PROFILE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_NECK_TUNE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_SETTINGS_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_NECK_SEQUENCE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_COLOR_PROFILE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;
CREATE SEQUENCE VGN_SETTINGS_OCTAVE_SEQ AS INTEGER START WITH 1000 INCREMENT BY 1;

CREATE TABLE vgn_user (
  user_id          INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_USER_SEQ PRIMARY KEY,
  user_login       VARCHAR(255) NOT NULL,
  user_name        VARCHAR(255) NOT NULL,
  user_pass        VARCHAR(255) NOT NULL,
  user_language    VARCHAR(4)   NOT NULL
);

create unique index idx_user_login on vgn_user(user_login);

CREATE TABLE vgn_color_profile (
  color_profile_id INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_COLOR_PROFILE_SEQ PRIMARY KEY,
  color            VARCHAR(255) NOT NULL
);

CREATE TABLE vgn_neck_profiles (
  neck_profile_id INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_NECK_PROFILE_SEQ PRIMARY KEY,
  default_profile BOOLEAN,
  profile_name    VARCHAR(255) NOT NULL,
  tonic           VARCHAR(255) NOT NULL,
  user_id         BIGINT       NOT NULL,
  settings_id     BIGINT
);

CREATE TABLE vgn_neck_tune (
  neck_tune_id            INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_NECK_TUNE_SEQ PRIMARY KEY,
  neck_tune_name          VARCHAR(100) NOT NULL,
  default_neck_tune       BOOLEAN      NOT NULL
);

CREATE TABLE vgn_string_tune (
  string_tune_id          INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_STRING_TUNE_SEQ PRIMARY KEY,
  string_number           BIGINT       NOT NULL,
  music_note              VARCHAR(100) NOT NULL,
  octave                  VARCHAR(30)  NOT NULL,
  neck_tune_id            BIGINT       NOT NULL
);

CREATE TABLE vgn_neck_settings (
  settings_id             INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_SETTINGS_SEQ PRIMARY KEY,
  frets_count             INTEGER      NOT NULL,
  neck_tune_id            INTEGER      NOT NULL,
  selection_tracks_tonic  BOOLEAN      NOT NULL,
  selection_type          VARCHAR(255) NOT NULL,
  show_note_custom_icons  BOOLEAN      NOT NULL,
  strings_count           INTEGER      NOT NULL,
  show_chord              BOOLEAN      NULL,
  show_chord_notes        BOOLEAN      NULL,
  selected_chord_code     VARCHAR(30)  NULL,
  build_chord_from_string INTEGER      NULL
);

CREATE TABLE vgn_neck_settings_octaves (
  settings_octave_id      INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_SETTINGS_OCTAVE_SEQ PRIMARY KEY,
  settings_id             BIGINT       NOT NULL,
  octave                  VARCHAR(30)  NOT NULL
);

CREATE TABLE vgn_note_property (
  note_property_id     INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_NOTE_PROPERTY_SEQ PRIMARY KEY,
  note_title           VARCHAR(255),
  note_type            VARCHAR(255),
  sequence_interval_id BIGINT NOT NULL
);

CREATE TABLE VGN_NECK_SEQUENCES (
  selected_sequence_id    INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_NECK_SEQUENCE_SEQ PRIMARY KEY,
  neck_sequence_index     BIGINT       NOT NULL,
  sequence_enabled        BOOLEAN      NOT NULL,
  sequence_tonic          VARCHAR(255) NOT NULL,
  selected_sequence_color VARCHAR(255) NOT NULL,
  sequence_id             BIGINT,
  settings_id             BIGINT       NOT NULL
);

CREATE TABLE vgn_sequence (
  sequence_id      INTEGER      GENERATED BY DEFAULT AS SEQUENCE VGN_SEQUENCE_SEQ PRIMARY KEY,
  sequence_name    VARCHAR(255) NOT NULL,
  sequence_type    VARCHAR(20)  NOT NULL,
  color_profile_id BIGINT NOT   NULL,
  sequence_order   BIGINT NOT   NULL,
  user_id          BIGINT       NOT NULL
);

CREATE TABLE vgn_sequence_interval (
  sequence_interval_id INTEGER GENERATED BY DEFAULT AS SEQUENCE VGN_SEQUENCE_INTERVAL_SEQ PRIMARY KEY,
  interval             INTEGER NOT NULL,
  color_profile_id     BIGINT,
  sequence_id          BIGINT  NOT NULL
);

ALTER TABLE vgn_string_tune
  ADD CONSTRAINT FK_STRING_TUNE_NECK_TUNE_ID
FOREIGN KEY (neck_tune_id)
REFERENCES vgn_neck_tune;

ALTER TABLE vgn_neck_settings
  ADD CONSTRAINT FK_NECK_SETTINGS_NECK_TUNE_ID
FOREIGN KEY (neck_tune_id)
REFERENCES vgn_neck_tune;

ALTER TABLE vgn_neck_profiles
  ADD CONSTRAINT FK_NP_SETTINGS_ID
FOREIGN KEY (settings_id)
REFERENCES vgn_neck_settings;

ALTER TABLE vgn_note_property
  ADD CONSTRAINT FK_NP_SEQUENCE_INTERVAL_ID
FOREIGN KEY (sequence_interval_id)
REFERENCES vgn_sequence_interval
ON DELETE CASCADE;

ALTER TABLE VGN_NECK_SEQUENCES
  ADD CONSTRAINT FK_SS_SEQUENCE_ID
FOREIGN KEY (sequence_id)
REFERENCES vgn_sequence;

ALTER TABLE vgn_neck_settings_octaves
  ADD CONSTRAINT FK_NSO_SETTINGS_ID
FOREIGN KEY (settings_id)
REFERENCES vgn_neck_settings
ON DELETE CASCADE;

ALTER TABLE VGN_NECK_SEQUENCES
  ADD CONSTRAINT FK_SS_SETTINGS_ID
FOREIGN KEY (settings_id)
REFERENCES vgn_neck_settings
ON DELETE CASCADE;

ALTER TABLE vgn_sequence
  ADD CONSTRAINT FK_SEQ_COLOR_PROFILE_ID
FOREIGN KEY (color_profile_id)
REFERENCES vgn_color_profile;

ALTER TABLE vgn_sequence_interval
  ADD CONSTRAINT FK_SI_COLOR_PROFILE_ID
FOREIGN KEY (color_profile_id)
REFERENCES vgn_color_profile
ON DELETE CASCADE;

ALTER TABLE vgn_sequence_interval
  ADD CONSTRAINT FK_SI_SEQUENCE_ID
FOREIGN KEY (sequence_id)
REFERENCES vgn_sequence
ON DELETE CASCADE;